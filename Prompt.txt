【バグ修正依頼】player●_UltCount が1回発動で2回増える（二重カウント）

■現象
- player●_UltCount（必殺技発動回数）が、1回発動したはずなのに2回扱いで増えている。
- 自分端末と相手端末の両方が更新している（二重でアップデート）疑い。

■前提（最重要）
- レイアウト/サイズ（キャラ情報エリア、中央エリア、スケール周り）は一切触らない。ロジックのみ。

■原因候補（高確度）
- 発動者側が Firestore に「ult発動」を書き込み
- 相手側も onSnapshot で同じイベントを受け取り、ローカルで ult適用（＝UltCount加算）を実行
- さらに発動者側でも onSnapshot で同じイベントを拾って再適用している
→ 結果、両端末（あるいは同一端末内でも2経路）で UltCount が二重加算される

■やってほしいこと（必須）
1) UltCount の更新は「単一の責務」にする（どちらか一方のみが更新）
   例：
   - 方式A: host（player1）だけが UltCount を Firestore 更新する（guestは書かない）
   - 方式B: 発動者だけが更新する（発動者判定が100%正しいことが前提）
   - 方式C: 「コマンドだけ書く」→「適用はhostのみ」→ 結果状態だけ同期（最も事故が少ない）

2) 二重適用防止の“冪等性ガード”を入れる
   - rooms に ultActionId（例: uuid + turn + usedBy）を保存
   - 各端末は「最後に処理した ultActionId」を保持し、同じIDは二度処理しない
   - Firestoreに processedUltActionId のようなフィールドを置いてもOK

3) UltCount は Firestore 側の単一地点で increment する
   - possible: transaction / runTransaction で「actionId未処理なら increment」まで原子的に行う
   - FieldValue.increment(1) を複数クライアントから叩かない構造にする

■デバッグ（必須）
- UltCount を増やす直前に必ずログ出しして「どの経路が2回走ってるか」確定する
  - device: myRole(host/guest), myUid
  - caller: useUltimate() / onSnapshot handler / applyUltEffect() など呼び出し元
  - actionId / turn / usedBy
  - increment対象フィールド名（player1_UltCount or player2_UltCount）
- 1回の発動でログが2回出てる箇所を特定し、その片方を“処理しない”ようにする

■完了条件
- 1回の必殺技発動につき、player●_UltCount が必ず +1 のみ増える（PC/スマホ両方、host/guest両方で再現なくなる）
